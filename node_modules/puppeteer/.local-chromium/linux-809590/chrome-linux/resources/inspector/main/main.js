import{RuntimeModel as e,SDKModel as t,ResourceTreeModel as n,ConsoleModel as o,NetworkManager as i,DOMDebuggerModel as r,DebuggerModel as s}from"../sdk/sdk.js";import{NetworkProject as a,ResourceMapping as c,PresentationConsoleMessageHelper as l,CSSWorkspaceBinding as d,DebuggerWorkspaceBinding as u,BreakpointManager as g,BlackboxManager as m}from"../bindings/bindings.js";import{Settings as p,UIString as h,AppProvider as f,QueryParamHandler as S,Console as x,Revealer as v}from"../common/common.js";import{Reload as w}from"../components/components.js";import{ExtensionServer as b}from"../extensions/extensions.js";import{InspectorFrontendHost as M,Platform as C,userMetrics as I,InspectorFrontendHostAPI as R,UserMetrics as _}from"../host/host.js";import{IsolatedFileSystemManager as k,FileSystemWorkspaceBinding as E,Persistence as T,NetworkPersistenceManager as D}from"../persistence/persistence.js";import{NumberUtilities as y}from"../platform/platform.js";import{InspectorBackend as P}from"../protocol_client/protocol_client.js";import{ThemeSupport as U}from"../theme_support/theme_support.js";import{ViewManager as L,UIUtils as F,InspectorView as A,ZoomManager as B,ContextMenu as N,Tooltip as W,DockController as H,ShortcutsScreen as O,Context as z,ActionRegistry as V,ShortcutRegistry as K,KeyboardShortcut as j,SearchableView as G,Toolbar as q,RootView as Z}from"../ui/ui.js";import{FileManager as J,Workspace as Q}from"../workspace/workspace.js";class X{constructor(n,o){o.addFlavorChangeListener(e.ExecutionContext,this._executionContextChanged,this),o.addFlavorChangeListener(t.Target,this._targetChanged,this),n.addModelListener(e.RuntimeModel,e.Events.ExecutionContextCreated,this._onExecutionContextCreated,this),n.addModelListener(e.RuntimeModel,e.Events.ExecutionContextDestroyed,this._onExecutionContextDestroyed,this),n.addModelListener(e.RuntimeModel,e.Events.ExecutionContextOrderChanged,this._onExecutionContextOrderChanged,this),this._targetManager=n,this._context=o,n.observeModels(e.RuntimeModel,this)}modelAdded(e){setImmediate(function(){this._context.flavor(t.Target)||this._context.setFlavor(t.Target,e.target())}.bind(this))}modelRemoved(n){const o=this._context.flavor(e.ExecutionContext);o&&o.runtimeModel===n&&this._currentExecutionContextGone();const i=this._targetManager.models(e.RuntimeModel);this._context.flavor(t.Target)===n.target()&&i.length&&this._context.setFlavor(t.Target,i[0].target())}_executionContextChanged(e){const n=e.data;n&&(this._context.setFlavor(t.Target,n.target()),this._ignoreContextChanged||(this._lastSelectedContextId=this._contextPersistentId(n)))}_contextPersistentId(e){return e.isDefault?e.target().name()+":"+e.frameId:""}_targetChanged(t){const n=t.data,o=this._context.flavor(e.ExecutionContext);if(!n||o&&o.target()===n)return;const i=n.model(e.RuntimeModel),r=i?i.executionContexts():[];if(!r.length)return;let s=null;for(let e=0;e<r.length&&!s;++e)this._shouldSwitchToContext(r[e])&&(s=r[e]);for(let e=0;e<r.length&&!s;++e)this._isDefaultContext(r[e])&&(s=r[e]);this._ignoreContextChanged=!0,this._context.setFlavor(e.ExecutionContext,s||r[0]),this._ignoreContextChanged=!1}_shouldSwitchToContext(e){return!(!this._lastSelectedContextId||this._lastSelectedContextId!==this._contextPersistentId(e))||!(this._lastSelectedContextId||!this._isDefaultContext(e))}_isDefaultContext(e){if(!e.isDefault||!e.frameId)return!1;if(e.target().parentTarget())return!1;const t=e.target().model(n.ResourceTreeModel),o=t&&t.frameForId(e.frameId);return!(!o||!o.isTopFrame())}_onExecutionContextCreated(e){this._switchContextIfNecessary(e.data)}_onExecutionContextDestroyed(t){const n=t.data;this._context.flavor(e.ExecutionContext)===n&&this._currentExecutionContextGone()}_onExecutionContextOrderChanged(e){const t=e.data.executionContexts();for(let e=0;e<t.length&&!this._switchContextIfNecessary(t[e]);e++);}_switchContextIfNecessary(t){return!(this._context.flavor(e.ExecutionContext)&&!this._shouldSwitchToContext(t))&&(this._ignoreContextChanged=!0,this._context.setFlavor(e.ExecutionContext,t),this._ignoreContextChanged=!1,!0)}_currentExecutionContextGone(){const t=this._targetManager.models(e.RuntimeModel);let n=null;for(let e=0;e<t.length&&!n;++e){const o=t[e].executionContexts();for(const e of o)if(this._isDefaultContext(e)){n=e;break}}if(!n)for(let e=0;e<t.length&&!n;++e){const o=t[e].executionContexts();if(o.length){n=o[0];break}}this._ignoreContextChanged=!0,this._context.setFlavor(e.ExecutionContext,n),this._ignoreContextChanged=!1}}var Y=Object.freeze({__proto__:null,ExecutionContextSelector:X});class ${constructor(){$._instanceForTest=this,runOnWindowLoad(this._loaded.bind(this))}static time(e){M.isUnderTest()||console.time(e)}static timeEnd(e){M.isUnderTest()||console.timeEnd(e)}async _loaded(){console.timeStamp("Main._loaded"),await Runtime.appStarted,Root.Runtime.setPlatform(C.platform()),Root.Runtime.setL10nCallback(ls),M.InspectorFrontendHostInstance.getPreferences(this._gotPreferences.bind(this))}_gotPreferences(e){console.timeStamp("Main._gotPreferences"),this._createSettings(e),this._createAppUI()}_createSettings(e){this._initializeExperiments();let t,n="";C.isCustomDevtoolsFrontend()?n="__custom__":Root.Runtime.queryParam("can_dock")||!Root.Runtime.queryParam("debugFrontend")||M.isUnderTest()||(n="__bundled__"),t=!M.isUnderTest()&&window.localStorage?new p.SettingsStorage(window.localStorage,void 0,void 0,()=>window.localStorage.clear(),n):new p.SettingsStorage({},void 0,void 0,void 0,n);const o=new p.SettingsStorage(e,M.InspectorFrontendHostInstance.setPreference,M.InspectorFrontendHostInstance.removePreference,M.InspectorFrontendHostInstance.clearPreferences,n);p.Settings.instance({forceNew:!0,globalStorage:o,localStorage:t}),self.Common.settings=p.Settings.instance(),M.isUnderTest()||(new p.VersionController).updateVersion()}_initializeExperiments(){Root.Runtime.experiments.register("applyCustomStylesheet","Allow custom UI themes"),Root.Runtime.experiments.register("captureNodeCreationStacks","Capture node creation stacks"),Root.Runtime.experiments.register("sourcesPrettyPrint","Automatically pretty print in the Sources Panel"),Root.Runtime.experiments.register("backgroundServices","Background web platform feature events",!0),Root.Runtime.experiments.register("backgroundServicesNotifications","Background services section for Notifications"),Root.Runtime.experiments.register("backgroundServicesPaymentHandler","Background services section for Payment Handler"),Root.Runtime.experiments.register("backgroundServicesPushMessaging","Background services section for Push Messaging"),Root.Runtime.experiments.register("blackboxJSFramesOnTimeline","Blackbox JavaScript frames on Timeline",!0),Root.Runtime.experiments.register("cssOverview","CSS Overview"),Root.Runtime.experiments.register("emptySourceMapAutoStepping","Empty sourcemap auto-stepping"),Root.Runtime.experiments.register("inputEventsOnTimelineOverview","Input events on Timeline overview",!0),Root.Runtime.experiments.register("liveHeapProfile","Live heap profile",!0),Root.Runtime.experiments.register("nativeHeapProfiler","Native memory sampling heap profiler",!0),Root.Runtime.experiments.register("protocolMonitor","Protocol Monitor"),Root.Runtime.experiments.register("developerResourcesView","Show developer resources view"),Root.Runtime.experiments.register("recordCoverageWithPerformanceTracing","Record coverage while performance tracing"),Root.Runtime.experiments.register("samplingHeapProfilerTimeline","Sampling heap profiler timeline",!0),Root.Runtime.experiments.register("showOptionToNotTreatGlobalObjectsAsRoots","Show option to take heap snapshot where globals are not treated as root"),Root.Runtime.experiments.register("sourceDiff","Source diff"),Root.Runtime.experiments.register("sourceOrderViewer","Source order viewer"),Root.Runtime.experiments.register("spotlight","Spotlight",!0),Root.Runtime.experiments.register("webauthnPane","WebAuthn Pane"),Root.Runtime.experiments.register("customKeyboardShortcuts","Enable custom keyboard shortcuts settings tab (requires reload)"),Root.Runtime.experiments.register("keyboardShortcutEditor","Enable keyboard shortcut editor",!0),Root.Runtime.experiments.register("timelineEventInitiators","Timeline: event initiators"),Root.Runtime.experiments.register("timelineFlowEvents","Timeline: flow events",!0),Root.Runtime.experiments.register("timelineInvalidationTracking","Timeline: invalidation tracking",!0),Root.Runtime.experiments.register("timelineShowAllEvents","Timeline: show all events",!0),Root.Runtime.experiments.register("timelineV8RuntimeCallStats","Timeline: V8 Runtime Call Stats on Timeline",!0),Root.Runtime.experiments.register("timelineWebGL","Timeline: WebGL-based flamechart"),Root.Runtime.experiments.register("timelineReplayEvent","Timeline: Replay input events",!0),Root.Runtime.experiments.register("wasmDWARFDebugging","WebAssembly Debugging: Enable DWARF support"),Root.Runtime.experiments.register("dualScreenSupport","Emulation: Support dual screen mode"),Root.Runtime.experiments.register("cssGridFeatures","Enable new CSS Grid debugging features (configuration options available in Layout sidebar pane in Elements after restart)"),Root.Runtime.experiments.register("movableTabs","Enable support to move tabs between panels"),Root.Runtime.experiments.enableExperimentsByDefault(["cssGridFeatures"]),Root.Runtime.experiments.cleanUpStaleExperiments();const e=Root.Runtime.queryParam("enabledExperiments");e&&Root.Runtime.experiments.setServerEnabledExperiments(e.split(";")),Root.Runtime.experiments.enableExperimentsTransiently(["backgroundServices","backgroundServicesNotifications","backgroundServicesPushMessaging","backgroundServicesPaymentHandler","customKeyboardShortcuts","webauthnPane"]),M.isUnderTest()&&Root.Runtime.queryParam("test").includes("live-line-level-heap-profile.js")&&Root.Runtime.experiments.enableForTest("liveHeapProfile");for(const e of Root.Runtime.experiments.enabledExperiments())I.experimentEnabledAtLaunch(e.name)}async _createAppUI(){$.time("Main._createAppUI"),self.UI.viewManager=L.ViewManager.instance(),self.Persistence.isolatedFileSystemManager=k.IsolatedFileSystemManager.instance();const e=p.Settings.instance().createSetting("uiTheme","systemPreferred");if(F.initializeUIUtils(document,e),"systemPreferred"===e.get()){window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",()=>{A.InspectorView.instance().displayReloadRequiredWarning(ls`The system-preferred color scheme has changed. To apply this change to DevTools, reload.`)})}F.installComponentRootStyles(document.body),this._addMainEventListeners(document);const n=!!Root.Runtime.queryParam("can_dock");self.UI.zoomManager=B.ZoomManager.instance({forceNew:!0,win:window,frontendHost:M.InspectorFrontendHostInstance}),self.UI.inspectorView=A.InspectorView.instance(),N.ContextMenu.initialize(),N.ContextMenu.installHandler(document),W.Tooltip.installHandler(document),self.SDK.consoleModel=o.ConsoleModel.instance(),self.UI.dockController=H.DockController.instance({forceNew:!0,canDock:n}),self.SDK.multitargetNetworkManager=i.MultitargetNetworkManager.instance({forceNew:!0}),self.SDK.domDebuggerManager=r.DOMDebuggerManager.instance({forceNew:!0}),t.TargetManager.instance().addEventListener(t.Events.SuspendStateChanged,this._onSuspendStateChanged.bind(this)),self.UI.shortcutsScreen=O.ShortcutsScreen.instance({forceNew:!0}),O.ShortcutsScreen.instance().section(h.UIString("Elements Panel")),O.ShortcutsScreen.instance().section(h.UIString("Styles Pane")),O.ShortcutsScreen.instance().section(h.UIString("Debugger")),O.ShortcutsScreen.instance().section(h.UIString("Console")),self.Workspace.fileManager=J.FileManager.instance({forceNew:!0}),self.Workspace.workspace=Q.WorkspaceImpl.instance(),self.Bindings.networkProjectManager=a.NetworkProjectManager.instance(),self.Bindings.resourceMapping=c.ResourceMapping.instance({forceNew:!0,targetManager:t.TargetManager.instance(),workspace:Q.WorkspaceImpl.instance()}),new l.PresentationConsoleMessageManager,self.Bindings.cssWorkspaceBinding=d.CSSWorkspaceBinding.instance({forceNew:!0,targetManager:t.TargetManager.instance(),workspace:Q.WorkspaceImpl.instance()}),self.Bindings.debuggerWorkspaceBinding=u.DebuggerWorkspaceBinding.instance({forceNew:!0,targetManager:t.TargetManager.instance(),workspace:Q.WorkspaceImpl.instance()}),self.Bindings.breakpointManager=g.BreakpointManager.instance({forceNew:!0,workspace:Q.WorkspaceImpl.instance(),targetManager:t.TargetManager.instance(),debuggerWorkspaceBinding:u.DebuggerWorkspaceBinding.instance()}),self.Extensions.extensionServer=b.ExtensionServer.instance({forceNew:!0}),new E.FileSystemWorkspaceBinding(k.IsolatedFileSystemManager.instance(),Q.WorkspaceImpl.instance()),self.Persistence.persistence=T.PersistenceImpl.instance({forceNew:!0,workspace:Q.WorkspaceImpl.instance(),breakpointManager:g.BreakpointManager.instance()}),self.Persistence.networkPersistenceManager=D.NetworkPersistenceManager.instance({forceNew:!0,workspace:Q.WorkspaceImpl.instance()}),new X(t.TargetManager.instance(),z.Context.instance()),self.Bindings.blackboxManager=m.BlackboxManager.instance({forceNew:!0,debuggerWorkspaceBinding:u.DebuggerWorkspaceBinding.instance()}),new ee;const s=V.ActionRegistry.instance({forceNew:!0});self.UI.actionRegistry=s,self.UI.shortcutRegistry=K.ShortcutRegistry.instance({forceNew:!0,actionRegistry:s}),O.ShortcutsScreen.registerShortcuts(),this._registerMessageSinkListener(),$.timeEnd("Main._createAppUI"),this._showAppUI(await self.runtime.extension(f.AppProvider).instance())}_showAppUI(e){$.time("Main._showAppUI");const t=e.createApp();H.DockController.instance().initialize(),t.presentUI(document);const n=V.ActionRegistry.instance().action("elements.toggle-element-search");n&&M.InspectorFrontendHostInstance.events.addEventListener(R.Events.EnterInspectElementMode,()=>{n.execute()},this),M.InspectorFrontendHostInstance.events.addEventListener(R.Events.RevealSourceLine,this._revealSourceLine,this),A.InspectorView.instance().createToolbars(),M.InspectorFrontendHostInstance.loadCompleted();const o=self.runtime.extensions(S.QueryParamHandler);for(const e of o){const t=Root.Runtime.queryParam(e.descriptor().name);null!==t&&e.instance().then(i.bind(null,t))}function i(e,t){t.handleQueryParam(e)}setTimeout(this._initializeTarget.bind(this),0),$.timeEnd("Main._showAppUI")}async _initializeTarget(){$.time("Main._initializeTarget");const e=await Promise.all(self.runtime.extensions("early-initialization").map(e=>e.instance()));for(const t of e)await t.run();M.InspectorFrontendHostInstance.readyForTest(),setTimeout(this._lateInitialization.bind(this),100),$.timeEnd("Main._initializeTarget")}_lateInitialization(){$.time("Main._lateInitialization"),this._registerShortcuts(),b.ExtensionServer.instance().initializeExtensions();const e=self.runtime.extensions("late-initialization"),t=[];for(const o of e){const e=o.descriptor().setting;async function n(t){t.data&&(p.Settings.instance().moduleSetting(e).removeChangeListener(n),(await o.instance()).run())}e&&!p.Settings.instance().moduleSetting(e).get()?p.Settings.instance().moduleSetting(e).addChangeListener(n):t.push(o.instance().then(e=>e.run()))}this._lateInitDonePromise=Promise.all(t),$.timeEnd("Main._lateInitialization")}lateInitDonePromiseForTest(){return this._lateInitDonePromise}_registerMessageSinkListener(){x.Console.instance().addEventListener(x.Events.MessageAdded,(function(e){e.data.show&&x.Console.instance().show()}))}_revealSourceLine(e){const t=e.data.url,n=e.data.lineNumber,o=e.data.columnNumber,i=Q.WorkspaceImpl.instance().uiSourceCodeForURL(t);i?v.reveal(i.uiLocation(n,o)):Q.WorkspaceImpl.instance().addEventListener(Q.Events.UISourceCodeAdded,(function e(i){const r=i.data;r.url()===t&&(v.reveal(r.uiLocation(n,o)),Q.WorkspaceImpl.instance().removeEventListener(Q.Events.UISourceCodeAdded,e))}))}_registerShortcuts(){const e=j.KeyboardShortcut,t=O.ShortcutsScreen.instance().section(h.UIString("All Panels"));let n=[e.makeDescriptor("[",j.Modifiers.CtrlOrMeta),e.makeDescriptor("]",j.Modifiers.CtrlOrMeta)];t.addRelatedKeys(n,h.UIString("Go to the panel to the left/right"));const o=h.UIString("Show console");t.addKey(e.makeDescriptor(j.Keys.Tilde,j.Modifiers.Ctrl),o),t.addKey(e.makeDescriptor(j.Keys.Esc),h.UIString("Toggle drawer")),H.DockController.instance().canDock()&&(t.addKey(e.makeDescriptor("M",j.Modifiers.CtrlOrMeta|j.Modifiers.Shift),h.UIString("Toggle device mode")),t.addKey(e.makeDescriptor("D",j.Modifiers.CtrlOrMeta|j.Modifiers.Shift),h.UIString("Toggle dock side"))),t.addKey(e.makeDescriptor("f",j.Modifiers.CtrlOrMeta),h.UIString("Search"));const i=C.isMac()?j.Modifiers.Meta|j.Modifiers.Alt:j.Modifiers.Ctrl|j.Modifiers.Shift,r=e.makeDescriptor("f",i);t.addKey(r,h.UIString("Search across all sources"));const s=K.ShortcutRegistry.instance().shortcutDescriptorsForAction("elements.toggle-element-search");s.length&&t.addKey(s[0],h.UIString("Select node to inspect"));const a=j.KeyboardShortcut.makeDescriptor("p",j.Modifiers.CtrlOrMeta);t.addKey(a,h.UIString("Go to source")),C.isMac()&&(n=[e.makeDescriptor("g",j.Modifiers.Meta),e.makeDescriptor("g",j.Modifiers.Meta|j.Modifiers.Shift)],t.addRelatedKeys(n,h.UIString("Find next/previous")))}_postDocumentKeyDown(e){e.handled||K.ShortcutRegistry.instance().handleShortcut(e)}_redispatchClipboardEvent(e){const t=new CustomEvent("clipboard-"+e.type,{bubbles:!0});t.original=e;const n=e.target&&e.target.ownerDocument,o=n?n.deepActiveElement():null;o&&o.dispatchEvent(t),t.handled&&e.preventDefault()}_contextMenuEventFired(e){(e.handled||e.target.classList.contains("popup-glasspane"))&&e.preventDefault()}_addMainEventListeners(e){e.addEventListener("keydown",this._postDocumentKeyDown.bind(this),!1),e.addEventListener("beforecopy",this._redispatchClipboardEvent.bind(this),!0),e.addEventListener("copy",this._redispatchClipboardEvent.bind(this),!1),e.addEventListener("cut",this._redispatchClipboardEvent.bind(this),!1),e.addEventListener("paste",this._redispatchClipboardEvent.bind(this),!1),e.addEventListener("contextmenu",this._contextMenuEventFired.bind(this),!0)}_onSuspendStateChanged(){const e=t.TargetManager.instance().allTargetsSuspended();A.InspectorView.instance().onSuspendStateChanged(e)}}class ee{constructor(){t.TargetManager.instance().addModelListener(s.DebuggerModel,s.Events.DebuggerPaused,this._debuggerPaused,this)}_debuggerPaused(e){t.TargetManager.instance().removeModelListener(s.DebuggerModel,s.Events.DebuggerPaused,this._debuggerPaused,this);const n=e.data,o=n.debuggerPausedDetails();z.Context.instance().setFlavor(t.Target,n.target()),v.reveal(o)}}new $;var te=Object.freeze({__proto__:null,MainImpl:$,ZoomActionDelegate:class{handleAction(e,t){if(M.InspectorFrontendHostInstance.isHostedMode())return!1;switch(t){case"main.zoom-in":return M.InspectorFrontendHostInstance.zoomIn(),!0;case"main.zoom-out":return M.InspectorFrontendHostInstance.zoomOut(),!0;case"main.zoom-reset":return M.InspectorFrontendHostInstance.resetZoom(),!0}return!1}},SearchActionDelegate:class{handleAction(e,t){let n=G.SearchableView.fromElement(document.deepActiveElement());if(!n){const e=A.InspectorView.instance().currentPanelDeprecated();if(e&&(n=e.searchableView()),!n)return!1}switch(t){case"main.search-in-panel.find":return n.handleFindShortcut();case"main.search-in-panel.cancel":return n.handleCancelSearchShortcut();case"main.search-in-panel.find-next":return n.handleFindNextShortcut();case"main.search-in-panel.find-previous":return n.handleFindPreviousShortcut()}return!1}},MainMenuItem:class{constructor(){this._item=new q.ToolbarMenuButton(this._handleContextMenu.bind(this),!0),this._item.setTitle(h.UIString("Customize and control DevTools"))}item(){return this._item}_handleContextMenu(e){if(H.DockController.instance().canDock()){const t=document.createElement("div");t.classList.add("flex-centered"),t.classList.add("flex-auto"),t.tabIndex=-1;const n=t.createChild("span","flex-auto");n.textContent=h.UIString("Dock side");const i=K.ShortcutRegistry.instance().shortcutsForAction("main.toggle-dock");n.title=h.UIString("Placement of DevTools relative to the page. (%s to restore last position)",i[0].title()),t.appendChild(n);const r=new q.Toolbar("",t);C.isMac()&&!U.instance().hasTheme()&&r.makeBlueOnHover();const s=new q.ToolbarToggle(h.UIString("Undock into separate window"),"largeicon-undock"),a=new q.ToolbarToggle(h.UIString("Dock to bottom"),"largeicon-dock-to-bottom"),c=new q.ToolbarToggle(h.UIString("Dock to right"),"largeicon-dock-to-right"),l=new q.ToolbarToggle(h.UIString("Dock to left"),"largeicon-dock-to-left");s.addEventListener(q.ToolbarButton.Events.MouseDown,e=>e.data.consume()),a.addEventListener(q.ToolbarButton.Events.MouseDown,e=>e.data.consume()),c.addEventListener(q.ToolbarButton.Events.MouseDown,e=>e.data.consume()),l.addEventListener(q.ToolbarButton.Events.MouseDown,e=>e.data.consume()),s.addEventListener(q.ToolbarButton.Events.Click,o.bind(null,H.State.Undocked)),a.addEventListener(q.ToolbarButton.Events.Click,o.bind(null,H.State.DockedToBottom)),c.addEventListener(q.ToolbarButton.Events.Click,o.bind(null,H.State.DockedToRight)),l.addEventListener(q.ToolbarButton.Events.Click,o.bind(null,H.State.DockedToLeft)),s.setToggled(H.DockController.instance().dockSide()===H.State.Undocked),a.setToggled(H.DockController.instance().dockSide()===H.State.DockedToBottom),c.setToggled(H.DockController.instance().dockSide()===H.State.DockedToRight),l.setToggled(H.DockController.instance().dockSide()===H.State.DockedToLeft),r.appendToolbarItem(s),r.appendToolbarItem(l),r.appendToolbarItem(a),r.appendToolbarItem(c),t.addEventListener("keydown",e=>{let t=0;if("ArrowLeft"===e.key)t=-1;else{if("ArrowRight"!==e.key)return;t=1}const n=[s,l,a,c];let o=n.findIndex(e=>e.element.hasFocus());o=y.clamp(o+t,0,n.length-1),n[o].element.focus(),e.consume(!0)}),e.headerSection().appendCustomItem(t)}const n=this._item.element;function o(t){H.DockController.instance().once(H.Events.AfterDockSideChanged).then(()=>{n.focus()}),H.DockController.instance().setDockSide(t),e.discard()}H.DockController.instance().dockSide()===H.State.Undocked&&t.TargetManager.instance().mainTarget()&&t.TargetManager.instance().mainTarget().type()===t.Type.Frame&&e.defaultSection().appendAction("inspector_main.focus-debuggee",h.UIString("Focus debuggee")),e.defaultSection().appendAction("main.toggle-drawer",A.InspectorView.instance().drawerVisible()?h.UIString("Hide console drawer"):h.UIString("Show console drawer")),e.appendItemsAtLocation("mainMenu");const i=e.defaultSection().appendSubMenuItem(h.UIString("More tools")),r=self.runtime.extensions("view",void 0,!0);for(const e of r){const t=e.descriptor();"issues-pane"!==t.id?"closeable"===t.persistence&&("drawer-view"!==t.location&&"panel"!==t.location||i.defaultSection().appendItem(e.title(),L.ViewManager.instance().showView.bind(L.ViewManager.instance(),t.id,!0))):i.defaultSection().appendItem(e.title(),()=>{I.issuesPanelOpenedFrom(_.IssueOpener.HamburgerMenu),L.ViewManager.instance().showView("issues-pane",!0)})}e.footerSection().appendSubMenuItem(h.UIString("Help")).appendItemsAtLocation("mainMenuHelp")}},SettingsButtonProvider:class{constructor(){this._settingsButton=q.Toolbar.createActionButtonForId("settings.show",{showLabel:!1})}item(){return this._settingsButton}},PauseListener:ee,sendOverProtocol:function(e,t){return new Promise((n,o)=>{P.test.sendRawMessage(e,t,(e,...t)=>e?o(e):n(t))})},ReloadActionDelegate:class{handleAction(e,t){switch(t){case"main.debug-reload":return w.reload(),!0}return!1}}});class ne{presentUI(e){const t=new Z.RootView;A.InspectorView.instance().show(t.element),t.attachToDocument(e),t.focus()}}var oe=Object.freeze({__proto__:null,SimpleApp:ne,SimpleAppProvider:class{createApp(){return new ne}}});export{Y as ExecutionContextSelector,te as MainImpl,oe as SimpleApp};
